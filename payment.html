<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Payment | Edutaxgrid</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta
    name="description"
    content="Complete your UPI payment and confirm your order for Edutaxgrid digital notes and ebooks."
  />

  <style>
    :root {
      --bg-main: #050509;
      --bg-elevated: #0b0b12;
      --bg-soft: #10101a;
      --accent: #6a5cff;
      --accent-strong: #b5a7ff;
      --accent-soft: rgba(106, 92, 255, 0.2);
      --text-main: #f8f8ff;
      --text-muted: #a0a0b8;
      --danger: #ff738f;
      --success: #5cf59f;
      --border-subtle: rgba(255, 255, 255, 0.08);
      --radius-lg: 20px;
      --radius-full: 999px;
      --shadow-soft: 0 20px 50px rgba(0, 0, 0, 0.7);
      --nav-height: 64px;
      --max-width: 1100px;
      --transition-fast: 0.18s ease-out;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html,
    body {
      height: 100%;
      scroll-behavior: smooth;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #17172c 0, #050509 55%);
      color: var(--text-main);
      -webkit-font-smoothing: antialiased;
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    button {
      font-family: inherit;
      border: none;
      cursor: pointer;
      background: none;
    }

    .page-shell {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .page-main {
      flex: 1;
      padding: 0 16px 28px;
    }

    .container {
      max-width: var(--max-width);
      margin: 0 auto;
    }

    /* NAVBAR */

    .eg-navbar {
      position: sticky;
      top: 0;
      z-index: 40;
      backdrop-filter: blur(18px);
      background: linear-gradient(
        to bottom,
        rgba(5, 5, 9, 0.96),
        rgba(5, 5, 9, 0.8),
        transparent
      );
      border-bottom: 1px solid rgba(255, 255, 255, 0.03);
    }

    .eg-nav-inner {
      display: flex;
      align-items: center;
      justify-content: space-between;
      height: var(--nav-height);
      max-width: var(--max-width);
      margin: 0 auto;
      padding: 0 16px;
    }

    .eg-nav-left {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .eg-logo-wrap {
      width: 32px;
      height: 32px;
      border-radius: 12px;
      overflow: hidden;
      background: radial-gradient(circle at 30% 0, #ffffff 0, #6a5cff 40%, #050509 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.08);
    }

    .eg-logo-wrap img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .eg-brand-text {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .eg-brand-name {
      font-weight: 600;
      font-size: 1.02rem;
      letter-spacing: 0.03em;
    }

    .eg-brand-tagline {
      font-size: 0.7rem;
      color: var(--text-muted);
    }

    .eg-nav-right {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .eg-cart-btn {
      position: relative;
      padding: 8px;
      border-radius: var(--radius-full);
      background: rgba(15, 15, 24, 0.9);
      border: 1px solid rgba(255, 255, 255, 0.06);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      transition: background var(--transition-fast), transform var(--transition-fast),
        border-color var(--transition-fast);
    }

    .eg-cart-btn:hover {
      background: rgba(26, 26, 40, 0.95);
      transform: translateY(-1px);
      border-color: rgba(255, 255, 255, 0.1);
    }

    .eg-cart-icon {
      width: 20px;
      height: 20px;
    }

    .eg-cart-icon svg {
      width: 100%;
      height: 100%;
      display: block;
    }

    .eg-cart-count {
      position: absolute;
      top: -4px;
      right: -4px;
      min-width: 18px;
      height: 18px;
      padding: 0 4px;
      border-radius: var(--radius-full);
      background: var(--accent);
      color: #fff;
      font-size: 0.65rem;
      font-weight: 600;
      display: none;
      align-items: center;
      justify-content: center;
      box-shadow: 0 0 0 1px rgba(5, 5, 9, 0.9);
    }

    .eg-burger-btn {
      width: 36px;
      height: 36px;
      border-radius: var(--radius-full);
      border: 1px solid rgba(255, 255, 255, 0.1);
      background: rgba(10, 10, 18, 0.95);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0;
      transition: background var(--transition-fast), transform var(--transition-fast),
        border-color var(--transition-fast);
    }

    .eg-burger-btn:hover {
      background: rgba(20, 20, 32, 0.98);
      transform: translateY(-1px);
      border-color: rgba(255, 255, 255, 0.2);
    }

    .eg-burger-lines {
      width: 18px;
      height: 14px;
      position: relative;
    }

    .eg-burger-lines span {
      position: absolute;
      left: 0;
      right: 0;
      height: 2px;
      border-radius: 999px;
      background: #f7f7ff;
      transition: transform 0.18s ease-out, opacity 0.18s ease-out;
    }

    .eg-burger-lines span:nth-child(1) {
      top: 0;
    }
    .eg-burger-lines span:nth-child(2) {
      top: 6px;
      width: 70%;
    }
    .eg-burger-lines span:nth-child(3) {
      top: 12px;
    }

    .eg-burger-menu {
      max-width: var(--max-width);
      margin: 0 auto;
      padding: 0 16px 10px;
      overflow: hidden;
      max-height: 0;
      opacity: 0;
      transition: max-height 0.2s ease-out, opacity 0.18s ease-out;
    }

    .eg-burger-menu-inner {
      background: rgba(7, 7, 14, 0.96);
      border-radius: 15px;
      border: 1px solid rgba(255, 255, 255, 0.06);
      padding: 10px;
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.7);
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .eg-nav-item {
      width: 100%;
      text-align: left;
      padding: 8px 10px;
      border-radius: 10px;
      font-size: 0.9rem;
      color: var(--text-muted);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      background: transparent;
      transition: background var(--transition-fast), color var(--transition-fast),
        transform var(--transition-fast);
    }

    .eg-nav-item span.label {
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .eg-nav-item span.badge {
      font-size: 0.65rem;
      padding: 2px 7px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.06);
      color: var(--text-main);
    }

    .eg-nav-item:hover {
      background: rgba(255, 255, 255, 0.04);
      color: var(--text-main);
      transform: translateY(-0.5px);
    }

    @media (min-width: 780px) {
      .eg-burger-menu-inner {
        flex-direction: row;
        justify-content: flex-end;
        gap: 8px;
      }
      .eg-nav-item {
        width: auto;
        font-size: 0.85rem;
      }
    }

    /* BUTTONS */

    .eg-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      font-size: 0.86rem;
      padding: 9px 16px;
      border-radius: var(--radius-full);
      border: 1px solid transparent;
      transition: background var(--transition-fast), transform var(--transition-fast),
        box-shadow var(--transition-fast), border-color var(--transition-fast), color var(--transition-fast);
      white-space: nowrap;
    }

    .eg-btn-primary {
      background: linear-gradient(135deg, var(--accent), #8e7bff);
      color: #fff;
      box-shadow: 0 14px 40px rgba(106, 92, 255, 0.5);
    }

    .eg-btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 18px 45px rgba(106, 92, 255, 0.65);
    }

    .eg-btn-ghost {
      background: transparent;
      color: var(--text-muted);
      border-color: rgba(255, 255, 255, 0.12);
    }

    .eg-btn-ghost:hover {
      background: rgba(255, 255, 255, 0.05);
      color: var(--text-main);
    }

    .eg-btn-sm {
      padding: 6px 12px;
      font-size: 0.78rem;
    }

    .eg-btn-lg {
      padding: 10px 20px;
      font-size: 0.92rem;
      font-weight: 500;
    }

    /* PAGE HEADER */

    .pay-header {
      padding-top: 18px;
      padding-bottom: 10px;
    }

    .pay-title-row {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    @media (min-width: 760px) {
      .pay-title-row {
        flex-direction: row;
        justify-content: space-between;
        align-items: flex-end;
      }
    }

    .pay-heading {
      font-size: 1.3rem;
      font-weight: 600;
    }

    .pay-sub {
      font-size: 0.8rem;
      color: var(--text-muted);
      max-width: 420px;
    }

    .pay-steps {
      font-size: 0.78rem;
      color: var(--text-muted);
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 6px;
    }

    .pay-step-pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 3px 8px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(255, 255, 255, 0.06);
    }

    /* SECTIONS WRAPPER */

    .pay-section {
      display: none;
    }

    .pay-section.active {
      display: block;
    }

    /* STEP 1: SUMMARY + QR */

    .pay-step1-layout {
      display: grid;
      gap: 14px;
    }

    @media (min-width: 880px) {
      .pay-step1-layout {
        grid-template-columns: minmax(0, 2.3fr) minmax(0, 2fr);
      }
    }

    .card {
      background: rgba(7, 7, 14, 0.97);
      border-radius: var(--radius-lg);
      border: 1px solid var(--border-subtle);
      padding: 12px 11px;
      box-shadow: var(--shadow-soft);
    }

    .card-title {
      font-size: 0.95rem;
      font-weight: 500;
      margin-bottom: 8px;
    }

    .order-items-list {
      font-size: 0.78rem;
      color: var(--text-muted);
      max-height: 170px;
      overflow-y: auto;
      padding-right: 2px;
      margin-bottom: 6px;
    }

    .order-items-list ul {
      list-style: none;
    }

    .order-items-list li {
      display: flex;
      justify-content: space-between;
      gap: 10px;
      padding: 3px 0;
      border-bottom: 1px dashed rgba(255, 255, 255, 0.06);
    }

    .order-items-list li span.name {
      flex: 1;
    }

    .order-items-list li span.qty {
      opacity: 0.7;
      min-width: 40px;
      text-align: right;
    }

    .order-items-list li span.price {
      min-width: 70px;
      text-align: right;
    }

    .order-summary-rows {
      margin-top: 6px;
      font-size: 0.85rem;
    }

    .summary-row {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 4px;
    }

    .summary-row span.label {
      color: var(--text-muted);
    }

    .summary-row span.value {
      font-weight: 500;
    }

    .summary-row.total span.value {
      color: var(--accent-strong);
      font-size: 0.95rem;
    }

    .summary-row.coupon span.value {
      color: var(--danger);
    }

    .pay-note {
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-top: 6px;
      line-height: 1.5;
    }

    .pay-checkboxes {
      margin-top: 10px;
      display: flex;
      flex-direction: column;
      gap: 5px;
      font-size: 0.78rem;
      color: var(--text-muted);
    }

    .pay-checkboxes label {
      display: flex;
      gap: 8px;
      align-items: flex-start;
      cursor: pointer;
    }

    .pay-checkboxes input[type="checkbox"] {
      margin-top: 2px;
      accent-color: #6a5cff;
    }

    .pay-step1-actions {
      margin-top: 10px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .qr-box {
      text-align: center;
      font-size: 0.78rem;
      color: var(--text-muted);
    }

    .qr-inner {
      margin-top: 6px;
      padding: 10px;
      border-radius: 18px;
      background: radial-gradient(circle at top, #262642 0, #050509 60%);
      border: 1px solid rgba(255, 255, 255, 0.12);
      display: inline-block;
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.85);
    }

    .qr-inner img {
      width: 180px;
      max-width: 60vw;
      border-radius: 12px;
      display: block;
    }

    .qr-amount-pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      margin-top: 6px;
      border-radius: 999px;
      background: rgba(0, 0, 0, 0.45);
      border: 1px solid rgba(255, 255, 255, 0.16);
      color: var(--text-main);
    }

    /* STEP 2: FORM */

    .pay-step2-layout {
      display: grid;
      gap: 14px;
    }

    @media (min-width: 900px) {
      .pay-step2-layout {
        grid-template-columns: minmax(0, 2.1fr) minmax(0, 2.3fr);
      }
    }

    .pay-side-summary {
      font-size: 0.8rem;
      color: var(--text-muted);
      line-height: 1.5;
    }

    .pay-side-summary ul {
      margin-top: 6px;
      padding-left: 14px;
    }

    .pay-side-summary li {
      margin-bottom: 4px;
    }

    .eg-input,
    .eg-textarea,
    .eg-select {
      width: 100%;
      padding: 8px 10px;
      border-radius: 10px;
      border: 1px solid rgba(255, 255, 255, 0.09);
      background: rgba(5, 5, 10, 0.97);
      color: var(--text-main);
      font-size: 0.8rem;
      outline: none;
      transition: border-color 0.18s ease-out, box-shadow 0.18s ease-out,
        background 0.18s ease-out;
    }

    .eg-input::placeholder,
    .eg-textarea::placeholder {
      color: rgba(160, 160, 184, 0.7);
    }

    .eg-input:focus,
    .eg-textarea:focus,
    .eg-select:focus {
      border-color: rgba(154, 139, 255, 0.9);
      box-shadow: 0 0 0 1px rgba(154, 139, 255, 0.9);
      background: rgba(6, 6, 14, 0.98);
    }

    .eg-textarea {
      min-height: 80px;
      resize: vertical;
    }

    .pay-form-grid {
      display: grid;
      gap: 8px;
    }

    .pay-form-row-inline {
      display: grid;
      gap: 6px;
    }

    @media (min-width: 680px) {
      .pay-form-row-inline {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    .pay-form-label {
      font-size: 0.76rem;
      color: var(--text-muted);
      margin-bottom: 2px;
    }

    .pay-policy-text {
      font-size: 0.74rem;
      color: var(--text-muted);
      margin-top: 4px;
    }

    .pay-policy-text a {
      text-decoration: underline;
      text-decoration-style: dotted;
      text-underline-offset: 2px;
    }

    .pay-form-checkboxes {
      margin-top: 4px;
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 0.75rem;
      color: var(--text-muted);
    }

    .pay-form-checkboxes label {
      display: flex;
      gap: 7px;
      align-items: flex-start;
      cursor: pointer;
    }

    .pay-form-checkboxes input[type="checkbox"] {
      margin-top: 2px;
      accent-color: #6a5cff;
    }

    .pay-form-footer-note {
      font-size: 0.74rem;
      color: var(--text-muted);
      margin-top: 6px;
    }

    .payment-status {
      font-size: 0.75rem;
      margin-top: 4px;
      color: var(--text-muted);
    }

    .payment-status[data-status-type="success"] {
      color: var(--success);
    }

    .payment-status[data-status-type="error"] {
      color: var(--danger);
    }

    .signin-gate {
      font-size: 0.8rem;
      color: var(--text-muted);
      line-height: 1.6;
    }

    .signin-gate strong {
      color: var(--accent-strong);
    }

    /* STEP 3: THANK YOU */

    .thankyou-card {
      text-align: center;
      padding: 24px 18px 20px;
      border-radius: 22px;
      background: radial-gradient(circle at top, #252547 0, #050509 60%);
      border: 1px solid rgba(255, 255, 255, 0.16);
      box-shadow: 0 24px 60px rgba(0, 0, 0, 0.85);
    }

    .thankyou-title {
      font-size: 1.4rem;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .thankyou-sub {
      font-size: 0.86rem;
      color: var(--text-muted);
      margin-bottom: 10px;
    }

    .thankyou-badges {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: center;
      margin-bottom: 10px;
      font-size: 0.75rem;
    }

    .thankyou-badge {
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.12);
      background: rgba(0, 0, 0, 0.45);
      color: var(--text-muted);
    }

    .thankyou-note {
      font-size: 0.8rem;
      color: var(--text-muted);
      margin-bottom: 8px;
      line-height: 1.6;
    }

    .thankyou-timer {
      font-size: 0.78rem;
      color: var(--accent-strong);
      margin-bottom: 10px;
    }

    /* FOOTER */

    .footer {
      border-top: 1px solid rgba(255, 255, 255, 0.04);
      padding: 12px 16px 18px;
      margin-top: 10px;
      background: rgba(3, 3, 8, 0.98);
    }

    .footer-inner {
      max-width: var(--max-width);
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      gap: 10px;
      font-size: 0.75rem;
      color: var(--text-muted);
    }

    @media (min-width: 720px) {
      .footer-inner {
        flex-direction: row;
        justify-content: space-between;
        align-items: center;
      }
    }

    .footer-links {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .footer-link {
      cursor: pointer;
      opacity: 0.83;
      transition: opacity 0.15s ease-out, color 0.15s ease-out;
    }

    .footer-link:hover {
      opacity: 1;
      color: var(--accent-strong);
    }

    .footer-brand {
      font-weight: 500;
      color: rgba(235, 235, 255, 0.9);
    }

    .footer-copy {
      opacity: 0.7;
    }

    .footer-badge {
      font-size: 0.72rem;
      padding: 3px 8px;
      border-radius: 999px;
      background: rgba(106, 92, 255, 0.12);
      border: 1px solid rgba(106, 92, 255, 0.4);
      color: var(--accent-strong);
    }
  </style>
</head>

<body>
  <div class="page-shell">
    <!-- NAVBAR -->
    <header class="eg-navbar">
      <div class="eg-nav-inner">
        <div class="eg-nav-left">
          <a href="index.html" class="eg-logo-wrap" aria-label="Edutaxgrid home">
            <img src="assets/images/logo.png" alt="Edutaxgrid logo" />
          </a>
          <div class="eg-brand-text">
            <div class="eg-brand-name">Edutaxgrid</div>
            <div class="eg-brand-tagline">UPI payment & confirmation</div>
          </div>
        </div>

        <div class="eg-nav-right">
          <button
            type="button"
            class="eg-cart-btn"
            aria-label="Open cart"
            data-button
            data-nav-link="cart"
          >
            <span class="eg-cart-icon">
              <svg viewBox="0 0 24 24" fill="none">
                <path
                  d="M6 6h15l-1.2 7.2a2 2 0 0 1-2 1.8H9.1a2 2 0 0 1-2-1.5L5 3.5H3"
                  stroke="#f7f7ff"
                  stroke-width="1.6"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <circle cx="10" cy="19.5" r="1.3" fill="#f7f7ff" />
                <circle cx="17" cy="19.5" r="1.3" fill="#f7f7ff" />
              </svg>
            </span>
            <span class="eg-cart-count" data-cart-count>0</span>
          </button>

          <button
            type="button"
            class="eg-burger-btn"
            aria-label="Open navigation"
            data-burger-toggle
          >
            <div class="eg-burger-lines">
              <span></span>
              <span></span>
              <span></span>
            </div>
          </button>
        </div>
      </div>

      <div class="eg-burger-menu" data-burger-menu data-open="false">
        <div class="eg-burger-menu-inner">
          <button
            type="button"
            class="eg-nav-item"
            data-auth-nav-switch
            data-nav-link="signin"
          >
            <span class="label">Sign in</span>
            <span class="badge">Google</span>
          </button>

          <button type="button" class="eg-nav-item" data-nav-link="home">
            <span class="label">Home</span>
          </button>

          <button type="button" class="eg-nav-item" data-nav-link="store">
            <span class="label">Store</span>
          </button>

          <button type="button" class="eg-nav-item" data-nav-link="cart">
            <span class="label">Cart</span>
          </button>

          <button type="button" class="eg-nav-item" data-nav-link="faq">
            <span class="label">FAQ</span>
          </button>
        </div>
      </div>
    </header>

    <!-- MAIN -->
    <main class="page-main">
      <div class="container">
        <section class="pay-header">
          <div class="pay-title-row">
            <div>
              <h1 class="pay-heading">Complete your payment</h1>
              <p class="pay-sub">
                Pay via UPI using the QR code, then submit your order details so we can email your digital notes.
              </p>
            </div>
            <div class="pay-steps">
              <span class="pay-step-pill">1. Scan & pay via UPI</span>
              <span class="pay-step-pill">2. Confirm payment details</span>
              <span class="pay-step-pill">3. Get PDFs on email</span>
            </div>
          </div>
        </section>

        <!-- STEP 1: ORDER SUMMARY + QR -->
        <section class="pay-section active" id="payment-step-1">
          <div class="pay-step1-layout">
            <div class="card">
              <div class="card-title">Order summary</div>
              <div class="order-items-list" id="pay-summary-items">
                <!-- JS: list items -->
              </div>

              <div class="order-summary-rows">
                <div class="summary-row">
                  <span class="label">Items total</span>
                  <span class="value" id="pay-items-total">‚Çπ0</span>
                </div>
                <div class="summary-row coupon" id="pay-coupon-row" style="display:none;">
                  <span class="label">
                    Coupon discount
                    <span id="pay-coupon-label"></span>
                  </span>
                  <span class="value" id="pay-coupon-value">-‚Çπ0</span>
                </div>
                <div class="summary-row total">
                  <span class="label">Amount to pay via UPI</span>
                  <span class="value" id="pay-grand-total">‚Çπ0</span>
                </div>
              </div>

              <p class="pay-note">
                Step 1: Use any UPI app (GPay, PhonePe, Paytm, etc.) to pay the exact
                <strong>‚ÄúAmount to pay via UPI‚Äù</strong> shown above. Then tick the confirmation
                checkboxes and click <strong>‚ÄúI have paid, go to form‚Äù</strong>.
              </p>

              <div class="pay-checkboxes">
                <label>
                  <input type="checkbox" id="pay-checkbox-paid" />
                  <span>
                    I have already completed the UPI payment using the amount shown above.
                  </span>
                </label>
                <label>
                  <input type="checkbox" id="pay-checkbox-policy" />
                  <span>
                    I understand that these are digital files only and there is
                    <strong>no refund</strong> once files are shared, as per
                    <a href="policies.html" target="_blank">Edutaxgrid policies</a>.
                  </span>
                </label>
              </div>

              <div class="pay-step1-actions">
                <button
                  type="button"
                  class="eg-btn eg-btn-primary eg-btn-lg"
                  id="pay-go-step2"
                  disabled
                >
                  I have paid, go to form ‚Üí
                </button>
                <button
                  type="button"
                  class="eg-btn eg-btn-ghost eg-btn-sm"
                  data-nav-link="cart"
                >
                  ‚Üê Back to cart
                </button>
              </div>
            </div>

            <div class="card qr-box">
              <div class="card-title">Scan to pay via UPI</div>
              <p>
                Open your UPI app, scan this QR and pay the same amount shown in the
                order summary.
              </p>
              <div class="qr-inner">
                <!-- Replace src with your actual QR image -->
                <img src="assets/images/qr.png" alt="UPI payment QR for Edutaxgrid" />
                <div class="qr-amount-pill">
                  <span>Amount:</span>
                  <strong id="pay-qr-amount">‚Çπ0</strong>
                </div>
              </div>
              <p class="pay-note">
                In the UPI notes, you can mention your name or ‚ÄúEdutaxgrid notes‚Äù for clarity.
              </p>
            </div>
          </div>
        </section>
        
         <!-- STEP 2: PAYMENT FORM -->
        <section class="pay-section" id="payment-step-2">
          <div class="pay-step2-layout">
            <div class="card">
              <div class="card-title">Almost done ‚Äî just confirm details</div>
              <div class="pay-side-summary">
                We‚Äôll match your form details with your UPI payment and then email your
                digital notes to you.
                <ul>
                  <li>
                    <strong>Items total:</strong>
                    <span id="pay-side-items-total">‚Çπ0</span>
                  </li>
                  <li id="pay-side-coupon-row" style="display:none;">
                    <strong>Coupon:</strong>
                    <span id="pay-side-coupon-label"></span>,
                    saved
                    <span id="pay-side-coupon-value">‚Çπ0</span>
                  </li>
                  <li>
                    <strong>Final payable:</strong>
                    <span id="pay-side-grand-total">‚Çπ0</span>
                  </li>
                </ul>
                <p style="margin-top:6px;">
                  Please double-check your <strong>email</strong> and
                  <strong>transaction ID</strong>. That‚Äôs how we will verify and send your files.
                </p>
              </div>
            </div>

            <div class="card">
              <!-- Visible only when signed in -->
              <div data-auth-visible="signed-in">
                <div class="card-title">Payment confirmation form</div>
                <form
                  id="payment-confirm-form"
                  class="pay-form-grid"
                  data-form="payment"
                  autocomplete="off"
                >
                  <div class="pay-form-row-inline">
                    <div>
                      <div class="pay-form-label">Your full name*</div>
                      <input
                        class="eg-input"
                        type="text"
                        name="name"
                        placeholder="Enter your name"
                        required
                      />
                    </div>
                    <div>
                      <div class="pay-form-label">Email address*</div>
                      <input
                        class="eg-input"
                        type="email"
                        name="email"
                        placeholder="Email where we should send PDFs"
                        required
                      />
                    </div>
                  </div>

                  <div class="pay-form-row-inline">
                    <div>
                      <div class="pay-form-label">Phone number*</div>
                      <input
                        class="eg-input"
                        type="tel"
                        name="phone"
                        placeholder="For contact if needed"
                        required
                      />
                    </div>
                    <div>
                      <div class="pay-form-label">UPI app used*</div>
                      <select class="eg-select" name="upi_app" required>
                        <option value="">Select app</option>
                        <option value="GPay">Google Pay</option>
                        <option value="PhonePe">PhonePe</option>
                        <option value="Paytm">Paytm</option>
                        <option value="BHIM">BHIM</option>
                        <option value="Other">Other</option>
                      </select>
                    </div>
                  </div>

                  <div>
                    <div class="pay-form-label">Ebooks / notes ordered*</div>
                    <textarea
                      class="eg-textarea"
                      name="ebooks_ordered"
                      id="pay-ebooks-ordered"
                      placeholder="This will be prefilled"
                      required
                     readonly
                    ></textarea>
                  </div>

                  <div class="pay-form-row-inline">
                    <div>
                      <div class="pay-form-label">Amount you paid (‚Çπ)*</div>
                      <input
                        class="eg-input"
                        type="number"
                        name="amount_paid"
                        id="pay-amount-paid-input"
                        placeholder="Enter the exact amount you paid"
                        min="1"
                        step="1"
                        required
                        readonly
                      />
                    </div>
                    <div>
                      <div class="pay-form-label">UPI transaction ID / UTR*</div>
                      <input
                        class="eg-input"
                        type="text"
                        name="transaction_id"
                        placeholder="Found in your UPI app"
                        required
                      />
                    </div>
                  </div>

                  <div>
                    <div class="pay-form-label">Notes for this order (optional)</div>
                    <textarea
                      class="eg-textarea"
                      name="order_notes"
                      placeholder="Example: Need notes urgently, or any specific instructions."
                    ></textarea>
                  </div>

                  <!-- Hidden technical fields (for your email record) -->
                  <input type="hidden" name="items_total" id="pay-items-total-input" />
                  <input type="hidden" name="coupon_code" id="pay-coupon-code-input" />
                  <input type="hidden" name="coupon_discount" id="pay-coupon-discount-input" />
                  <input type="hidden" name="grand_total" id="pay-grand-total-input" />
                  <input type="hidden" name="cart_items_raw" id="pay-items-raw-input" />

                  <div class="pay-form-checkboxes">
                    <label>
                      <input type="checkbox" name="confirm_correct" required />
                      <span>
                        I confirm that the payment details I‚Äôve filled are accurate and match my UPI app.
                      </span>
                    </label>
                    <label>
                      <input type="checkbox" name="accept_policy" required />
                      <span>
                        I have read and accepted the
                        <a href="policies.html" target="_blank">no-refund policy</a>
                        for digital products.
                      </span>
                    </label>
                  </div>

                  <!-- hCaptcha widget placeholder -->
                  <div class="h-captcha" data-captcha="true"></div>
                  
                  <button type="submit" class="eg-btn eg-btn-primary eg-btn-lg">
                    Submit payment details
                  </button>
                  <p class="payment-status" data-form-status>
                    After submitting, please wait while we verify and email your notes (within 36 hours).
                  </p>

                  <p class="pay-form-footer-note">
                    If you made any mistake in the form, just reply to the confirmation email with correct details.
                  </p>
                </form>
              </div>

              <!-- Shown when NOT signed in -->
              <div data-auth-visible="signed-out" class="signin-gate">
                <div class="card-title">Sign in required</div>
                <p>
                  To protect your orders and email delivery, please
                  <strong>sign in with Google</strong> before submitting payment details.
                </p>
                <p style="margin-top:6px;">
                  This helps us match your UPI payment with your email and provide better
                  support if anything goes wrong.
                </p>
                <button
                  type="button"
                  class="eg-btn eg-btn-primary eg-btn-sm"
                  data-auth-google
                  style="margin-top:10px;"
                >
                  Continue with Google
                </button>
                <p style="margin-top:8px;font-size:0.74rem;color:var(--text-muted);">
                  After signing in, this page will show the payment form automatically.
                </p>
              </div>
            </div>
          </div>
        </section>

        <!-- STEP 3: THANK YOU -->
        <section class="pay-section" id="payment-step-3">
          <div class="thankyou-card">
            <div class="thankyou-title">Thank you for your order üéâ</div>
            <p class="thankyou-sub">
              Your payment details have been submitted. We‚Äôll now verify your UPI transaction and send your digital notes.
            </p>
            <div class="thankyou-badges">
              <span class="thankyou-badge">Delivery: within 36 hours</span>
              <span class="thankyou-badge">Channel: email inbox</span>
              <span class="thankyou-badge">Product type: digital PDFs only</span>
            </div>
            <p class="thankyou-note">
              Please keep an eye on your <strong>email inbox</strong> (and spam folder) for files from Edutaxgrid.
              If you don‚Äôt receive them within 36 hours, you can:
            </p>
            <p class="thankyou-note">
              ‚Ä¢ Check the <button type="button" class="footer-link" data-nav-link="faq">FAQ section</button><br />
              ‚Ä¢ Or send us a message through the <button type="button" class="footer-link" data-nav-link="feedback">feedback form</button> on the home page.
            </p>
            <p class="thankyou-timer">
              Redirecting you to home in
              <strong><span id="pay-redirect-timer">20</span>s</strong>‚Ä¶
            </p>
            <button
              type="button"
              class="eg-btn eg-btn-primary eg-btn-sm"
              data-nav-link="home"
            >
              Go to home now
            </button>
          </div>
        </section>
      </div>
    </main>

    <!-- FOOTER -->
    <footer class="footer">
      <div class="footer-inner">
        <div>
          <div class="footer-brand">Edutaxgrid</div>
          <div class="footer-copy">
            ¬© <span id="footer-year"></span> ‚Ä¢ UPI payment page
          </div>
        </div>
        <div class="footer-links">
          <button type="button" class="footer-link" data-nav-link="home">
            Home
          </button>
          <button type="button" class="footer-link" data-nav-link="store">
            Store
          </button>
          <button type="button" class="footer-link" data-nav-link="cart">
            Cart
          </button>
          <a href="policies.html" class="footer-link">Policies & terms</a>
          <span class="footer-badge">Digital only ‚Ä¢ No refunds</span>
        </div>
      </div>
    </footer>
  </div>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-auth-compat.js"></script>

  <!-- Your JS -->
  <script src="assets/js/product.js"></script>
  <script src="assets/js/script.js"></script>
  <script src="assets/js/authentication.js"></script>

  <script>
    document.getElementById("footer-year").textContent =
      new Date().getFullYear();

    (function () {
      if (!window.ProductStore) return;

      const itemsContainer = document.getElementById("pay-summary-items");
      const itemsTotalSpan = document.getElementById("pay-items-total");
      const couponRow = document.getElementById("pay-coupon-row");
      const couponLabel = document.getElementById("pay-coupon-label");
      const couponValue = document.getElementById("pay-coupon-value");
      const grandTotalSpan = document.getElementById("pay-grand-total");
      const qrAmountSpan = document.getElementById("pay-qr-amount");

      const sideItemsTotal = document.getElementById("pay-side-items-total");
      const sideCouponRow = document.getElementById("pay-side-coupon-row");
      const sideCouponLabel = document.getElementById("pay-side-coupon-label");
      const sideCouponValue = document.getElementById("pay-side-coupon-value");
      const sideGrandTotal = document.getElementById("pay-side-grand-total");

      const ebooksOrderedTextarea = document.getElementById("pay-ebooks-ordered");
      const amountPaidInput = document.getElementById("pay-amount-paid-input");

      const hiddenItemsTotalInput = document.getElementById("pay-items-total-input");
      const hiddenCouponCodeInput = document.getElementById("pay-coupon-code-input");
      const hiddenCouponDiscountInput = document.getElementById("pay-coupon-discount-input");
      const hiddenGrandTotalInput = document.getElementById("pay-grand-total-input");
      const hiddenItemsRawInput = document.getElementById("pay-items-raw-input");

      const checkboxPaid = document.getElementById("pay-checkbox-paid");
      const checkboxPolicy = document.getElementById("pay-checkbox-policy");
      const goStep2Btn = document.getElementById("pay-go-step2");

      const step1 = document.getElementById("payment-step-1");
      const step2 = document.getElementById("payment-step-2");
      const step3 = document.getElementById("payment-step-3");

      const COUPON_STORAGE_KEY = "edutaxgrid_active_coupon";

      const COUPONS = {
        WELCOME10: {
          code: "WELCOME10",
          type: "percent",
          value: 10,
          minTotal: 0,
          label: "WELCOME10 (10% off)"
        },
        STUDY50: {
          code: "STUDY50",
          type: "flat",
          value: 50,
          minTotal: 249,
          label: "STUDY50 (‚Çπ50 off above ‚Çπ249)"
        }
      };

      function format(amount) {
        if (window.ProductStore && window.ProductStore.formatCurrency) {
          return window.ProductStore.formatCurrency(amount);
        }
        return "‚Çπ" + amount;
      }

      function loadActiveCouponCode() {
        try {
          return localStorage.getItem(COUPON_STORAGE_KEY) || "";
        } catch (e) {
          return "";
        }
      }

      function renderSummary() {
        const detailed = window.ProductStore.getCartDetailed();
        let subtotal = window.ProductStore.getCartTotal();

        if (!detailed.length || subtotal <= 0) {
          itemsContainer.innerHTML =
            '<p class="pay-note">Your cart seems empty. Please go back to the <button type="button" class="footer-link" data-nav-link="store">store</button> and add some notes before paying.</p>';
          itemsTotalSpan.textContent = format(0);
          grandTotalSpan.textContent = format(0);
          qrAmountSpan.textContent = format(0);
          goStep2Btn.disabled = true;
          checkboxPaid.disabled = true;
          checkboxPolicy.disabled = true;
          if (sideItemsTotal) sideItemsTotal.textContent = format(0);
          if (sideGrandTotal) sideGrandTotal.textContent = format(0);
          return;
        }

        // Build items list
        const itemsLines = [];
        itemsContainer.innerHTML =
          "<ul>" +
          detailed
            .map(function (item) {
              const p = item.product;
              const line = p.name + " x" + item.quantity + " ‚Äì " + format(item.lineTotal);
              itemsLines.push(line);
              return (
                '<li><span class="name">' +
                p.name +
                '</span><span class="qty">√ó' +
                item.quantity +
                '</span><span class="price">' +
                format(item.lineTotal) +
                "</span></li>"
              );
            })
            .join("") +
          "</ul>";
          
          
        // Coupon logic
        let activeCode = loadActiveCouponCode();
        let activeCoupon = activeCode ? COUPONS[activeCode] : null;
        let discountAmount = 0;

        if (activeCoupon && subtotal >= activeCoupon.minTotal) {
          if (activeCoupon.type === "percent") {
            discountAmount = Math.round((subtotal * activeCoupon.value) / 100);
          } else {
            discountAmount = activeCoupon.value;
          }
          if (discountAmount > subtotal) discountAmount = subtotal;
        } else {
          activeCoupon = null;
        }

        const grandTotal = subtotal - discountAmount;

        // Fill main summary
        itemsTotalSpan.textContent = format(subtotal);
        grandTotalSpan.textContent = format(grandTotal);
        qrAmountSpan.textContent = format(grandTotal);

        // Side summary
        if (sideItemsTotal) sideItemsTotal.textContent = format(subtotal);
        if (sideGrandTotal) sideGrandTotal.textContent = format(grandTotal);

        if (activeCoupon && discountAmount > 0) {
          couponRow.style.display = "flex";
          couponLabel.textContent = " ‚Ä¢ " + activeCoupon.label;
          couponValue.textContent = "-" + format(discountAmount);

          sideCouponRow.style.display = "list-item";
          sideCouponLabel.textContent = activeCoupon.label;
          sideCouponValue.textContent = format(discountAmount);

          hiddenCouponCodeInput.value = activeCoupon.code;
          hiddenCouponDiscountInput.value = discountAmount;
        } else {
          couponRow.style.display = "none";
          couponLabel.textContent = "";
          couponValue.textContent = "-‚Çπ0";

          sideCouponRow.style.display = "none";
          sideCouponLabel.textContent = "";
          sideCouponValue.textContent = "‚Çπ0";

          hiddenCouponCodeInput.value = "";
          hiddenCouponDiscountInput.value = 0;
        }

        // Prefill form helpers
        if (ebooksOrderedTextarea) {
          ebooksOrderedTextarea.value =
            itemsLines.join("\n");
        }

        if (amountPaidInput) {
          amountPaidInput.value = grandTotal;
        }

        hiddenItemsTotalInput.value = subtotal;
        hiddenGrandTotalInput.value = grandTotal;
        hiddenItemsRawInput.value = itemsLines.join(" | ");

        goStep2Btn.disabled = !(checkboxPaid.checked && checkboxPolicy.checked);
      }

      // Checkbox logic
      function updateStep1ButtonState() {
        goStep2Btn.disabled = !(checkboxPaid.checked && checkboxPolicy.checked);
      }

      checkboxPaid.addEventListener("change", updateStep1ButtonState);
      checkboxPolicy.addEventListener("change", updateStep1ButtonState);

      // Step navigation
      goStep2Btn.addEventListener("click", function () {
        if (goStep2Btn.disabled) return;
        step1.classList.remove("active");
        step2.classList.add("active");
        window.scrollTo({ top: 0, behavior: "smooth" });
      });

      // Expose thank-you flow (fallback if not defined in script.js)
      if (!window.PageFlow) window.PageFlow = {};
      if (!window.PageFlow.startPaymentThankYouFlow) {
        window.PageFlow.startPaymentThankYouFlow = function () {
          step1.classList.remove("active");
          step2.classList.remove("active");
          step3.classList.add("active");
          window.scrollTo({ top: 0, behavior: "smooth" });

          var timerSpan = document.getElementById("pay-redirect-timer");
          var remaining = 20;
          var interval = setInterval(function () {
            remaining -= 1;
            if (remaining <= 0) {
              clearInterval(interval);
              window.location.href = "index.html";
            } else if (timerSpan) {
              timerSpan.textContent = remaining;
            }
          }, 1000);
        };
      }

      // Initial render
      step1.classList.add("active");
      renderSummary();
    })();
  </script>
  <script src="https://js.hcaptcha.com/1/api.js" async defer></script>
  <script src="https://cdn.jsdelivr.net/npm/@hcaptcha/vanilla-hcaptcha"></script>
</body>
</html>
